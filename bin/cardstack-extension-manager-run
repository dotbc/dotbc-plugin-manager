#!/usr/bin/env node

const program = require('commander')
  .version(require('../package.json').version);

const name = 'run <extension-main-path>'
const description = 'runs an extension project with IPC communication to the cardstack-desktop app';
const usage = `\n  usage:\n\n    ${name} - ${description}\n`;

if (module.parent) {
  module.exports.name = name;
  module.exports.description = description;
  return;
}

program
  .command(name, description)
    .action((mainFilePath) => {

      const path = require('path');
      const run = require('../lib/run');

      const fullFilePath = mainFilePath[0] === '.' ? 
        path.join(process.cwd(), mainFilePath) : 
        path.normalize(mainFilePath);

      run(fullFilePath, (err) => {
        if (err) throw err;

        console.log(`started extension at \'${mainFilePath}\'...`);

      });

    });

program.parse(process.argv);

if ( ! process.argv[2] || process.argv[2] === '--help')
  return program.help();;